<!doctype html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
		<link rel="icon" type="image/x-icon" href="images/favicon.ico"/>
		<link rel="icon" type="image/png" href="images/favicon.png"/>

		<title>QR Code Generator</title>

		<script src="js/jquery-1.9.1.js"></script>
		<script src="js/jquery-qrcode.js"></script>
		<script src="js/jquery-ui.js"></script>
		

		<link rel="stylesheet" href="css/jquery-ui.css" />
		<link rel="stylesheet" href="css/style.css" />
	</head>

	<body>
		<!-- Tooltips: -->
		<script>
			$(document).tooltip({
				position: {
					my: 'center top',
					at: 'center bottom + 5',
				},
				show: {
					duration: 'fast'
				},
				hide: {
					effect: 'hide'
				}
			});
		</script>

		<!-- Tabs: -->
		<script>
			$(function() {
				$('#tabs').tabs();
			});
		</script>
		<div id="tabs">
			<ul>
				<li><a href="#tab">BSV QR Code Generator</a></li>
			</ul>
			<div id="tab">
				<div>
					
					<div id="address_input">
						<label id="address_label" for="scale_value">Address: </label>
						<input id="address_value" type="text"></input>
						<span title="The Bitcoin Address to encode." style="vertical-align: middle; float: right;"><span class="ui-icon ui-icon-info" style="display: inline-block;"></span></span>
					</div>
					<div id="scale_input">
						<label id="scale_label" for="scale_value">Size: </label>
						<input id="scale_value" type="text"></input>
						<div id="scale_slider"></div>
						<span title="The size of the resulting QR code image." style="vertical-align: middle; float: right;"><span class="ui-icon ui-icon-info" style="display: inline-block;"></span></span>
					</div>
					<div id="style_image_input">
						<label id="style_image_label">Image: </label>
						<input id="style_image_1" type="radio" name="style_image" value="1"><label class="style_image" for="style_image_1"><img src="images/1.png"/></label>
						<input id="style_image_2" type="radio" name="style_image" value="2" checked="checked"><label class="style_image" for="style_image_2"><img src="images/2.png"/></label>
						<input id="style_image_3" type="radio" name="style_image" value="3"><label class="style_image" for="style_image_3"><img src="images/3.png"/></label>
						<input id="style_image_4" type="radio" name="style_image" value="4"><label class="style_image" for="style_image_4"><img src="images/4.png"/></label>
						<input id="style_image_5" type="radio" name="style_image" value="5"><label class="style_image" for="style_image_5"><img src="images/5.png"/></label>
						<input id="style_image_6" type="radio" name="style_image" value="6"><label class="style_image" for="style_image_6"><img src="images/6.png"/></label>
						<input id="style_image_7" type="radio" name="style_image" value="7"><label class="style_image" for="style_image_7"><img src="images/7.png"/></label>
						<input id="style_image_8" type="radio" name="style_image" value="8"><label class="style_image" for="style_image_8"><img src="images/8.png"/></label>
						<input id="style_image_9" type="radio" name="style_image" value="9"><label class="style_image" for="style_image_9"><img src="images/9.png"/></label>
						<input id="style_image_10" type="radio" name="style_image" value="10"><label class="style_image" for="style_image_10"><img src="images/10.png"/></label>
						<span title="The image to be embedded into the QR code." style="vertical-align: middle; float: right;"><span class="ui-icon ui-icon-info" style="display: inline-block;"></span></span>
					</div>
					
				</div>
				<div style="text-align: center;">
					<a id="canvas_download">
						<canvas id="canvas" style="border: 1px dashed;"/>
					</a>
				</div>
				<div>
					<span title="Make sure you test your QR code before using! Why? Because the image embedding reduces the error correction ability of the QR code and it might not be readable anymore!" style="display: block; text-align: center; margin: 20 0 0 0; "><span style="padding: 14 10 10 10;">Important: <span class="ui-icon ui-icon-info" style="display: inline-block;"></span></span></span>
				</div>
			</div>
		</div>
		<!-- Donate Widget: >
		<div style="width: 240px; margin: auto; padding: 20px;">
			<script>
				CoinWidgetCom.go({
					wallet_address: "1F4MdxyUMMhyx76s7tH7Gaho1puGLx3fgX"
					, currency: "bitcoin"
					, counter: "hide"
					, alignment: "bc"
					, qrcode: true
					, auto_show: false
					, lbl_button: "Donate Bitcoin"
					, lbl_address: "Bitcoin Address:"
					, lbl_count: "donations"
					, lbl_amount: "BTC"
				});
			</script>
			<script>
				CoinWidgetCom.go({
					wallet_address: "ltc1q7eztqq9dqqjvsej6kpqlusra62ne3y2wztc4ma"
					, currency: "litecoin"
					, counter: "hide"
					, alignment: "bc"
					, qrcode: true
					, auto_show: false
					, lbl_button: "Donate Litecoin"
					, lbl_address: "Litecoin Address:"
					, lbl_count: "donations"
					, lbl_amount: "LTC"
				});
			</script -->
		</div>

		<!-- Defaults: -->
		<script>
			var COINTYPE_DEFAULT = 'bitcoin';
			var ADDRESS_DEFAULT = '1F4MdxyUMMhyx76s7tH7Gaho1puGLx3fgX';
			var SIZE = 50;

			var STYLE_DEFAULT = 2;

			var SCALE_MIN = 1;
			var SCALE_DEFAULT = 5;
			var SCALE_MAX = 10;

			var STYLE_IMAGE_SCALE_MIN = 5;
			var STYLE_IMAGE_SCALE_DEFAULT = 5;
			var STYLE_IMAGE_SCALE_MAX = 20;
			var STYLE_IMAGE_SCALE_FACTOR = 10;
		</script>

		<!-- Settings: -->
		<script>
			var coinType = COINTYPE_DEFAULT;
			var address = ADDRESS_DEFAULT; 
			var scale = SCALE_DEFAULT;
			var styleImage = STYLE_DEFAULT;
			var styleImageScale = STYLE_IMAGE_SCALE_DEFAULT;
		</script>

		<!-- Coin Type Radio Buttons: -->
		<script>
			$(function() {
				$('#coin_type_input').buttonset();
				$('#coin_type_input').on('change', function() {
					coinType = $('input[name=coin_type]:checked', '#coin_type_input').val();
					updateCanvas();
				});
			});
		</script>

		<!-- Address field: -->
		<script>
			$(function() {
				$('#address_value').val(ADDRESS_DEFAULT);
				$('#address_value').on('input',function() {
					address = this.value;
					updateCanvas();
				});

				$('#scale_value').val((scale * SIZE) + 'px');
			});
		</script>

		<!-- Scale slider: -->
		<script>
			$(function() {
				$('#scale_slider').slider({
					value: SCALE_DEFAULT,
					min: SCALE_MIN,
					max: SCALE_MAX,
					slide: function(event, ui) {
						$('#scale_value').val((ui.value * SIZE) + 'px');

						scale = ui.value;
						updateCanvas();
					}
				});

				$('#scale_value').val((scale * SIZE) + 'px');
			});
		</script>

		<!-- Style Image Radio Buttons: -->
		<script>
			$(function() {
				$('#style_image_input').buttonset();
				$('#style_image_input').on('change', function() {
					styleImage = $('input[name=style_image]:checked', '#style_image_input').val();
					updateCanvas();
				});
			});
		</script>

		

		<!-- Canvas Updating: -->
		<script>
			function updateCanvas() {
				/* HTML5 Canvas: */
				var canvas = document.getElementById('canvas');
				var context = canvas.getContext('2d');
				context.imageSmoothingEnabled = context.webkitImageSmoothingEnabled = context.mozImageSmoothingEnabled = context.oImageSmoothingEnabled = false;

				/* Size canvas: */
				$('#canvas').attr("width", SIZE * scale);
				$('#canvas').attr("height", SIZE * scale);

				/* Size context: */
				context.scale(scale, scale);

				/* Draw base QR-Code: */
				$('#canvas').empty().qrcode({
					render: 'canvas',
					background: '#FFF',
					ecLevel: 'H',
					moduleSize: 1,
					size: SIZE,
					fill: '#000',
					quiet: 1,
					text: coinType + ':' + address
				});

				/* Overlay selected image: */
				var image = new Image();
				image.onload = function() {
					var x = (SIZE - this.width) / 2;
					var y = (SIZE - this.height) / 2;

					context.translate(SIZE / 2, SIZE / 2);
					context.scale(styleImageScale / STYLE_IMAGE_SCALE_FACTOR, styleImageScale / STYLE_IMAGE_SCALE_FACTOR);
					context.imageSmoothingEnabled = context.webkitImageSmoothingEnabled = context.mozImageSmoothingEnabled = context.oImageSmoothingEnabled = false;
					context.drawImage(image, -this.width / 2, -this.height / 2);

					updateDataURL();
				};
				image.src = "images/" + styleImage + '.png';

				function updateDataURL() {
					$('#canvas_download').attr('href', canvas.toDataURL());
					$('#canvas_download').attr('title', coinType + ':' + address);
				};

				updateDataURL();
			};
		</script>

		<!-- Initial Draw: -->
		<script>
			updateCanvas();
		</script>
	</body>
</html>
